<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NewNote</title>
    <link rel="stylesheet" href="note.css">
</head>
<body>
    <h2>MY NOTES</h2>
    <div id="info"></div>
    <img id="img" src="clap.gif" alt="">
    <audio id="audio" src="alert.mp3"></audio>
    <!-- <video id="vid" src="clap.gif" controls></video> -->
    <div id="folderContainer">
        <button id="add" onclick="addNote()">Add Note</button>
        <button id="add" onclick="addList()">Add List</button>
        <div class="folder" id="folder1"> </div> 
        <div class="folder" id="folder2"> </div>
    </div>
</body>
<script>
    let info=document.getElementById("info");
    let vid=document.getElementById("audio");
    function congrats()
    {
        vid.play();
        img=document.getElementById("img");
        if(img.style.display == "none")
        {
            console.log("\ncongrats");
            img.style.display= "block";
            setTimeout(congrats,2000);
            //its gonna call the func again
            //this time the display will be block so it'll become none
        }
        else
        img.style.display= "none";
    }
    ///////////////////////////////////////////////////
    //FOR NOTES
    let n1=0;
    let tym,s,now;
    let targetTym = new Array(10);
    let presentTym = new Array(10);
    let TymVal = new Array(10);
  
    function showReminder() //when targetTym and presentTym are taken as integers
    {
        congrats();
        //i wanted the audio to play 2 times while showing the reminder
        //but it didnt play twice maybe bcoz i didnt give enough time gap b/w 
        //audio plays. So,i used settimeout to give a gap of 3 secs
        setTimeout(()=>{vid.play()} , 3000);
        //a problem was found wherein alert executed early than gif and audio
        //it didnt allow them to work until ok was clicked in the alert box
        //so i used setTimeout to slow down alert call
        //moreover i had to place alert func within another func
        //bcoz alert was geting called immeditately in settimeout()
        setTimeout(()=>{alert(`Alert From Note ${n1}\n${TymVal[n1-1]}`)},3000);
        
    }

    function addTimer()
    {
        tym=document.getElementsByClassName("tym");
        TymVal[n1-1] = tym[n1-1].value;
        console.log("\nvalue of tym input is "+TymVal );
        s = TymVal[n1-1]+"";
        let hrs = parseInt(s.substring(0,2));
        let min = parseInt(s.substring(3,5));
        targetTym[n1-1] = hrs*60 + min;
        console.log("\ntarget time is "+targetTym);
        
        now=new Date();
        presentTym[n1-1] = now.getHours()*60 + now.getMinutes();
        //presentTym contains the time present time in seconds
        console.log("\npresent time is "+presentTym[n1-1]);

        timeDifference = targetTym[n1-1] - presentTym[n1-1];
        console.log("\ntime difference is "+timeDifference);
        //The timeDifference is in minutes
        //but setTimeout() uses milliseconds so convert it
        setTimeout(showReminder,timeDifference*60*1000);
    } 

    function addNote()
    {
        n1++;
        let x=document.getElementById("folder1");
        x.innerHTML += `<div class="note" id="n${n1}">
            <div class="noteElement">${n1}</div>
            <textarea  class="noteElement"> </textarea >
            <input class="tym , noteElement" type="time">
            <button onclick='addTimer()' class="noteElement">Add Remainder</button>
            </div>`;
           info.innerHTML=`No. of Notes = ${n1}</br>No. of Lists = ${n2}`;
            // congrats();
            vid.play();
    }
//////////////////////////////////////////////////////////////////
//FOR LISTS
//i have added a scope {} below to use all variables within this scope only
//but it didnt allow me to access the below variables at the console directly (in web browser)
//therefore i commented this scope
//{
    let n2=0;//keeps no. of lists(notes) formed
    function list(x,y)
    {
       this.no=x;//list no
       this.ic=y;//contains item counts of each list(note)
    }
    let listArray=[];
    //speciality of lists in js:
    //even though it declared it as empty
    //i can add elements using arr[0],arr[1]...without using append() or push()
    function addList()
    {
        n2++;
        listArray[n2-1]= new list(n2-1,1);
        let x=document.getElementById("folder2");
        x.innerHTML += `<div class="note" id="l${n2}"> 
            <div class="noteElement">${n2}</div>
            <input class="tym , noteElement" type="time">
            <button onclick='addTimer()' class="noteElement">Add Remainder</button>
            <button onclick='addListItem("l${n2}")' class='noteElement'>+</button>    
            <textarea id="t${listArray[n2-1].ic}" class="noteElement"> </textarea >
                </div>`;
                console.log("\nno of items = "+listArray[n2-1].ic);
                info.innerHTML=`No. of Notes = ${n1}</br>No. of Lists = ${n2}`;
                // congrats();
                vid.play();
    }
            function addListItem(ListId) 
            {
                let k=ListId.substring(1);
                k=parseInt(k);
                console.log("\nno of items = "+(++listArray[k-1].ic));
                let x=document.getElementById(ListId); //we need to access the required list(note) not the folder 
                x.innerHTML += `<textarea id="t${listArray[n2-1].ic}" class="noteElement"> </textarea ></div>`;
                    //the above code works really fine but u need to place the "+" button above text area
                    //we to place "+" button below the textareas 
            }
//}            
</script>
</html>